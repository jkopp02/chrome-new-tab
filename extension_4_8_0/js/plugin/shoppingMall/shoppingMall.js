(function($){$.shoppingMall=function(){return new shoppingMall()};var shoppingMall=(function(){var shoppingMall=function(){};shoppingMall.prototype={container:'',init:function(){var self=this;self.initShoppingMallApp()},initShoppingMallApp:function(){var self=this;self.container.find('.shoppingMallApp').remove();var data=PDI.get('shoppingMall');if(data!=''&&(new Date().getTime()-data.time<=1*360000)){self.template(data)}else{$.get('http://cn.am5.com/index.php?module=api&action=featureApi&ui_locale='+_langPre+'&t='+new Date().getTime(),function(data){if(data){var data=JSON.parse(data);data['time']=new Date().getTime();PDI.set('shoppingMall','',data);self.template(data)}})}},template:function(data){var self=this;if(DBOX.width>120&&DBOX.height>=120){self.container.find('.boxLogo').attr("bgHidden","true");var content='<div class="shoppingMallApp"><div class="shoppingMallMain"><div class="shoppingMallLeft"><div class="shoppingMallLogo" style="background-image:url('+data.picked_image+');"><div class="discount"><label>'+Math.floor((data.promo_price/data.price)*100)/ 10 + getI18nMsg('shoppingMallDiscountUnit') + '</label></div></div></div><div class="shoppingMallRight"><div class="title" title="' + data.title + '">' + data.title + '</div><div class="shoppingMallBuy"><label class="h1">ï¿¥' + data.promo_price + '</label>&nbsp;&nbsp;' + getI18nMsg('shoppingMallBuyNow') + '</div><div class="data"title="' + getI18nMsg('shoppingMallSellCount') + '(' + data.sell_count_in_30 + ') | ' + getI18nMsg('shoppingMallRateCount') + '(' + data.rateCounter + ')">' + getI18nMsg('shoppingMallSellCount') + '(' + data.sell_count_in_30 + ')|' + getI18nMsg('shoppingMallRateCount') + '(' + data.rateCounter + ')</div></div></div></div>';self.container.append(content);self.container.find('.shoppingMallApp').css("top",parseInt((DBOX.height-120)/2)+"px");self.container.find('.shoppingMallBuy').unbind('click').bind('click',function(){openTab(targetSwitch,data.url,tabID,ctrlKey)});if(DBOX.width<225||DBOX.radius>45){self.container.find(".shoppingMallMain").addClass("small")}if(!self.container.hasClass('quick')){self.container.find('.boxLogo').addClass("hidden");if(DBOX.radius<30){self.container.find('.boxLogo').css('borderBottomColor','rgba(255, 101, 0, .6)');if(!DBOX.titleShow){self.container.find('.boxTitle').css('backgroundColor','rgba(255, 101, 0, .4)')}}}else{self.container.find('.boxLogo').removeClass("hidden")}}},getDialogContent:function(){var self=this;return'<div class="shoppingMallContainer"><div class="shoppingMallBody"><iframe src="http://cn.am5.com/index.php?action=shoppingMall&ui_locale='+_langPre+'&t='+new Date().getTime()+'" width="780" height="569" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" scrolling="auto"></iframe></div></div>'}};return shoppingMall})()})(jq);var shoppingMall=$.shoppingMall();